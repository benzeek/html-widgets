<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Break Timer</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-color: #121212;
            color: #ffffff;
        }
        .btn-primary, .btn-completed {
            width: 200px;
            font-size: 16px;
        }
        .btn-primary {
            background-color: #1e88e5;
            border-color: #1e88e5;
        }
        .btn-completed {
            background-color: #43a047;
            border-color: #43a047;
            color: #ffffff;
        }
        .timer {
            font-size: 1.2rem;
            color: #ff7043;
            margin-top: 5px;
        }
    </style>
</head>
<body class="container my-5">

    <div class="text-center">
        <h1>Break Timer</h1>
        <p>Click the button to start your break. Break duration: 15 minutes</p>

        <!-- Morning Button -->
        <div class="mb-3">
            <button id="morningBreakBtn" class="btn btn-primary" onclick="startBreak('morningBreakBtn')">
                Start Morning Break
            </button>
            <div id="morningBreakTimer" class="timer"></div>
        </div>

        <!-- Afternoon Button -->
        <div class="mb-3">
            <button id="afternoonBreakBtn" class="btn btn-primary" onclick="startBreak('afternoonBreakBtn')">
                Start Afternoon Break
            </button>
            <div id="afternoonBreakTimer" class="timer"></div>
        </div>
    </div>

    <script>
        // Function to start the break timer
        function startBreak(buttonId) {
            const button = document.getElementById(buttonId);
            const timerId = buttonId === 'morningBreakBtn' ? 'morningBreakTimer' : 'afternoonBreakTimer';
            const timerDisplay = document.getElementById(timerId);

            // Disable button and initialize countdown
            button.disabled = true;
            button.textContent = 'Break in Progress...';

            let remainingTime = 15 * 60; // 15 minutes in seconds
            displayTime(remainingTime, timerDisplay);

            // Countdown timer
            const countdown = setInterval(() => {
                remainingTime--;
                displayTime(remainingTime, timerDisplay);

                if (remainingTime <= 0) {
                    clearInterval(countdown);
                    button.textContent = 'Break Completed';
                    button.classList.add('btn-completed');
                    timerDisplay.textContent = ''; // Clear timer display after completion

                    // Save the completed status in localStorage with today's date
                    const dateKey = `${buttonId}_completed`;
                    localStorage.setItem(dateKey, new Date().toLocaleDateString());
                }
            }, 1000);
        }

        function displayTime(seconds, element) {
            const minutes = Math.floor(seconds / 60);
            const sec = seconds % 60;
            element.textContent = `${minutes}:${sec < 10 ? '0' : ''}${sec} remaining`;
        }

        // reset buttons at 8:30 AM daily
        function resetButtons() {
            const now = new Date();
            const resetTime = new Date();
            resetTime.setHours(8, 30, 0, 0);

            // Reset buttons if the current time is past 8:30 AM
            if (now >= resetTime) {
                document.getElementById('morningBreakBtn').disabled = false;
                document.getElementById('afternoonBreakBtn').disabled = false;
                document.getElementById('morningBreakBtn').textContent = 'Start Morning Break';
                document.getElementById('afternoonBreakBtn').textContent = 'Start Afternoon Break';
                document.getElementById('morningBreakBtn').classList.remove('btn-completed');
                document.getElementById('afternoonBreakBtn').classList.remove('btn-completed');
            }
        }

        // On page load, check if breaks were completed today
        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date().toLocaleDateString();

            // Check each button's completion status
            ['morningBreakBtn', 'afternoonBreakBtn'].forEach(buttonId => {
                const dateKey = `${buttonId}_completed`;
                if (localStorage.getItem(dateKey) === today) {
                    const button = document.getElementById(buttonId);
                    button.textContent = 'Break Completed';
                    button.classList.add('btn-completed');
                    button.disabled = true;
                }
            });

            // Schedule reset for next 8:30 AM
            setInterval(resetButtons, 60 * 1000); // Check every minute
        });
    </script>

</body>
</html>
